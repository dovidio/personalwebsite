<!DOCTYPE html>
<html lang="it" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Utilizzare Volley per eseguire richieste http - Umberto D&#39;Ovidio</title>
  <meta name="description" content="Come effettuare richieste http su Android con Volley"><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Umberto D\u0027Ovidio",
    
    "url": "dovidio.github.com\/personalwebsite"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "dovidio.github.com\/personalwebsite"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "dovidio.github.com\/personalwebsite",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "dovidio.github.com\/personalwebsite\/it\/post\/2017-08-24-volley-android\/",
          "name": "Utilizzare volley per eseguire richieste http"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Umberto D\u0027Ovidio"
  },
  "headline": "Utilizzare Volley per eseguire richieste http",
  "description" : "Come effettuare richieste http su Android con Volley",
  "inLanguage" : "it",
  "wordCount":  1337 ,
  "datePublished" : "2017-08-24T00:00:00",
  "dateModified" : "2017-08-24T00:00:00",
  "image" : "dovidio.github.com\/personalwebsite",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "dovidio.github.com\/personalwebsite\/it\/post\/2017-08-24-volley-android\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "dovidio.github.com\/personalwebsite",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "dovidio.github.com\/personalwebsite",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Utilizzare Volley per eseguire richieste http" />
<meta property="og:description" content="Come effettuare richieste http su Android con Volley">
<meta property="og:url" content="dovidio.github.com/personalwebsite/it/dovidio.github.com/personalwebsite/it/post/2017-08-24-volley-android/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Umberto D&#39;Ovidio" />

  <meta name="twitter:title" content="Utilizzare Volley per eseguire richieste http" />
  <meta name="twitter:description" content="Come effettuare richieste http su Android con Volley">
  <meta name="twitter:card" content="summary" />
  <link href='dovidio.github.com/personalwebsite/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.72.0" />
  <link rel="alternate" href="dovidio.github.com/personalwebsite/it/index.xml" type="application/rss+xml" title="Umberto D&#39;Ovidio"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="dovidio.github.com/personalwebsite/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="dovidio.github.com/personalwebsite/css/syntax.css" /><link rel="stylesheet" href="dovidio.github.com/personalwebsite/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Attiva/disattiva la navigazione</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="dovidio.github.com/personalwebsite/it/">Umberto D&#39;Ovidio</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/dovidio.github.com/personalwebsite/it">Blog</a>
            </li>
          
        
          
            <li>
              <a title="Now" href="/dovidio.github.com/personalwebsite/it/page/now/">Now</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/dovidio.github.com/personalwebsite/it/tags">Tags</a>
            </li>
          
        

        
          
            <li>
              
                
                  <a href="/en" lang="en">en</a>
                
              
                
              
            </li>
          
        

        
      </ul>
    </div>

    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Utilizzare Volley per eseguire richieste http</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Redatto il August 24, 2017
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;7&nbsp;minuti
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1337&nbsp;parole
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Umberto D'Ovidio
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p><strong>Volley</strong> è una libreria HTTP creata da Google che permette di fare operazioni di networking in Android in maniera semplice e veloce.</p>
<p>Supporta nativamente stringhe, Json e immagini.
Il punto di forza rispetto a tutte le altre librerie in Android è sicuramente il supporto di Google che la utilizza attivamente nelle sue app.  Uno dei punti deboli è la scarsa documentazione, per cui spesso bisogna andare a leggersi il <a href="https://github.com/google/volley">codice sorgente</a> per capire come ottenere determinati risultati.</p>
<h3 id="una-semplice-richiesta-http-in-volley">Una semplice richiesta http in volley</h3>
<p>Prima di tutto, se vuoi utilizzare Volley nel tuo progetto Android, dovrai aggiungerla alle dipendenze nel file build.gradle:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-gradle" data-lang="gradle">dependencies <span style="color:#f92672">{</span>
    <span style="color:#f92672">...</span>
    compile <span style="color:#e6db74">&#39;com.android.volley:volley:1.0.0&#39;</span>
<span style="color:#f92672">}</span></code></pre></div>
<p>Volley utilizza una coda per gestire le richieste http. È possibile creare l&rsquo;oggetto <em>RequestQueue</em> utilizzando il metodo statico <em>newRequestQueue()</em> della classe <em>Volley</em>. Una volta ottenuta una coda di richieste, possiamo creare la nostra richiesta e aggiungerla alla coda. Volley supporta di default 3 tipi di richieste:</p>
<ul>
<li><em>StringRequest</em></li>
<li><em>JsonRequest</em></li>
<li><em>InputStreamRequest</em></li>
</ul>
<p>E&rsquo; possibile poi creare un tipo di richiesta personalizzato estendendo l&rsquo;oggetto <em>Request</em> e implementando i metodi <em>parseNetworkResponse()</em> e <em>deliverResponse()</em>. Per ora vedremo un semplice esempio che utilizza la <em>StringRequest</em>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> 
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VolleyTutorial</span> <span style="color:#66d9ef">extends</span> AppCompatActivity <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String TAG_RESPONSE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;VOLLEYRESPONSE&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String TAG_ERROR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;VOLLEYERROR&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String TAG_REQUEST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;VOLLEYREQUEST&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> Button sendRequestButton<span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>Bundle savedInstanceState<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">super</span><span style="color:#f92672">.</span><span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>savedInstanceState<span style="color:#f92672">);</span>
        setContentView<span style="color:#f92672">(</span>R<span style="color:#f92672">.</span><span style="color:#a6e22e">layout</span><span style="color:#f92672">.</span><span style="color:#a6e22e">activity_volley_tutorial</span><span style="color:#f92672">);</span>
        sendRequestButton <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>Button<span style="color:#f92672">)</span> findViewById<span style="color:#f92672">(</span>R<span style="color:#f92672">.</span><span style="color:#a6e22e">id</span><span style="color:#f92672">.</span><span style="color:#a6e22e">request_btn</span><span style="color:#f92672">);</span>

        <span style="color:#75715e">// Instantiate the RequestQueue.
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">final</span> RequestQueue queue <span style="color:#f92672">=</span> Volley<span style="color:#f92672">.</span><span style="color:#a6e22e">newRequestQueue</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">final</span> String url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://www.google.com&#34;</span><span style="color:#f92672">;</span>

        sendRequestButton<span style="color:#f92672">.</span><span style="color:#a6e22e">setOnClickListener</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> View<span style="color:#f92672">.</span><span style="color:#a6e22e">OnClickListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">(</span>View view<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                faiRichiesta1<span style="color:#f92672">(</span>queue<span style="color:#f92672">,</span> url<span style="color:#f92672">);</span>
                faiRichiesta2<span style="color:#f92672">(</span>queue<span style="color:#f92672">,</span> url<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">faiRichiesta1</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> RequestQueue queue<span style="color:#f92672">,</span> <span style="color:#66d9ef">final</span> String url<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        StringRequest stringRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> url<span style="color:#f92672">,</span>
                <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">Listener</span><span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
                    <span style="color:#a6e22e">@Override</span>
                    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onResponse</span><span style="color:#f92672">(</span>String response<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// Display the first 500 characters of the response string.
</span><span style="color:#75715e"></span>                        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;La risposta 2 è: &#34;</span> <span style="color:#f92672">+</span> response<span style="color:#f92672">.</span><span style="color:#a6e22e">substring</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> 500<span style="color:#f92672">));</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">},</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">ErrorListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onErrorResponse</span><span style="color:#f92672">(</span>VolleyError error<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">e</span><span style="color:#f92672">(</span>TAG_ERROR<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;non ha funzionato: &#34;</span> <span style="color:#f92672">+</span> error<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">());</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>stringRequest<span style="color:#f92672">);</span>
        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;aggiunta richiesta 2 alla coda&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">faiRichiesta2</span><span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> RequestQueue queue<span style="color:#f92672">,</span> <span style="color:#66d9ef">final</span> String url<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        StringRequest stringRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> url<span style="color:#f92672">,</span>
                <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">Listener</span><span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
                    <span style="color:#a6e22e">@Override</span>
                    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onResponse</span><span style="color:#f92672">(</span>String response<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// Display the first 500 characters of the response string.
</span><span style="color:#75715e"></span>                        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;La risposta 2 è: &#34;</span> <span style="color:#f92672">+</span> response<span style="color:#f92672">.</span><span style="color:#a6e22e">substring</span><span style="color:#f92672">(</span>0<span style="color:#f92672">,</span> 500<span style="color:#f92672">));</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">},</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">ErrorListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onErrorResponse</span><span style="color:#f92672">(</span>VolleyError error<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">e</span><span style="color:#f92672">(</span>TAG_ERROR<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;non ha funzionato: &#34;</span> <span style="color:#f92672">+</span> error<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">());</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>stringRequest<span style="color:#f92672">);</span>
        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;aggiunta richiesta 2 alla coda&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    
<span style="color:#f92672">}</span></code></pre></div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"> 
<span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;android.support.constraint.ConstraintLayout</span> <span style="color:#a6e22e">xmlns:android=</span><span style="color:#e6db74">&#34;http://schemas.android.com/apk/res/android&#34;</span>
    <span style="color:#a6e22e">xmlns:app=</span><span style="color:#e6db74">&#34;http://schemas.android.com/apk/res-auto&#34;</span>
    <span style="color:#a6e22e">xmlns:tools=</span><span style="color:#e6db74">&#34;http://schemas.android.com/tools&#34;</span>
    <span style="color:#a6e22e">android:layout_width=</span><span style="color:#e6db74">&#34;match_parent&#34;</span>
    <span style="color:#a6e22e">android:layout_height=</span><span style="color:#e6db74">&#34;match_parent&#34;</span>
    <span style="color:#a6e22e">tools:context=</span><span style="color:#e6db74">&#34;io.dovid.volleytutorial.VolleyTutorial&#34;</span><span style="color:#f92672">&gt;</span>

    <span style="color:#f92672">&lt;Button</span>
        <span style="color:#a6e22e">android:id=</span><span style="color:#e6db74">&#34;@+id/request_btn&#34;</span>
        <span style="color:#a6e22e">android:layout_width=</span><span style="color:#e6db74">&#34;wrap_content&#34;</span>
        <span style="color:#a6e22e">android:layout_height=</span><span style="color:#e6db74">&#34;wrap_content&#34;</span>
        <span style="color:#a6e22e">android:layout_marginBottom=</span><span style="color:#e6db74">&#34;8dp&#34;</span>
        <span style="color:#a6e22e">android:layout_marginLeft=</span><span style="color:#e6db74">&#34;8dp&#34;</span>
        <span style="color:#a6e22e">android:layout_marginRight=</span><span style="color:#e6db74">&#34;8dp&#34;</span>
        <span style="color:#a6e22e">android:layout_marginTop=</span><span style="color:#e6db74">&#34;8dp&#34;</span>
        <span style="color:#a6e22e">android:text=</span><span style="color:#e6db74">&#34;@string/send_request&#34;</span>
        <span style="color:#a6e22e">app:layout_constraintBottom_toBottomOf=</span><span style="color:#e6db74">&#34;parent&#34;</span>
        <span style="color:#a6e22e">app:layout_constraintLeft_toLeftOf=</span><span style="color:#e6db74">&#34;parent&#34;</span>
        <span style="color:#a6e22e">app:layout_constraintRight_toRightOf=</span><span style="color:#e6db74">&#34;parent&#34;</span>
        <span style="color:#a6e22e">app:layout_constraintTop_toTopOf=</span><span style="color:#e6db74">&#34;parent&#34;</span> <span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/android.support.constraint.ConstraintLayout&gt;</span></code></pre></div>
<p>Questa activity ha un bottone che una volta cliccato manda due richieste http a google e logga la risposta nella console di android studio. Creiamo una StringRequest con il costruttore che chiede il metodo della richiesta (GET, POST, PUT, DELETE etc&hellip;), una stringa che rappresenta un url, un oggetto Response.Listener ed un Error.Listener. Abbiamo creato entrambi i listener inline creando due classi anonime.</p>
<p>Nella prima classe dobbiamo implementare il metodo <em>onResponse(String response)</em> che verrà chiamato quando riceviamo una risposta valida. Nella seconda classe invece implementiamo il metodo <em>onErrorResponse(VolleyError error)</em> che viene chiamato qualora ci sia un errore nella richiesta o nella risposta http.</p>
<p>Data la natura asincrona della libreria, la seconda richiesta http che facciamo viene mandata prima di ricevere la risposta dalla prima richiesta. Ci sono però dei casi in cui vogliamo eseguire una richiesta http solo un&rsquo;altra richiesta ha ricevuto una risposta. Per esempio facciamo finta di voler fare una richiesta a google, una a yahoo e una a bing. Inoltre vogliamo che la richiesta a yahoo venga fatta dopo aver ricevuto risposta da google, e la richiesta bing deve essere fatta dopo aver ricevuto risposta da yahoo. Potremmo fare così:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">        <span style="color:#66d9ef">final</span> String googleUrl <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://www.google.com&#34;</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">final</span> String yahooUrl <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://yahoo.com/&#34;</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">final</span> String bingUrl <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://www.bing.com&#34;</span><span style="color:#f92672">;</span>

        StringRequest googleRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> googleUrl<span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">Listener</span><span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onResponse</span><span style="color:#f92672">(</span>String response<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;risposta google: &#34;</span> <span style="color:#f92672">+</span> response<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">());</span>
                StringRequest yahooRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> yahooUrl<span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">Listener</span><span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
                    <span style="color:#a6e22e">@Override</span>
                    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onResponse</span><span style="color:#f92672">(</span>String response<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;risposta yahoo: &#34;</span> <span style="color:#f92672">+</span> response<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">());</span>
                        StringRequest bingRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> bingUrl<span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">Listener</span><span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;()</span> <span style="color:#f92672">{</span>
                            <span style="color:#a6e22e">@Override</span>
                            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onResponse</span><span style="color:#f92672">(</span>String response<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;risposta bing: &#34;</span> <span style="color:#f92672">+</span> response<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">());</span>
                            <span style="color:#f92672">}</span>
                        <span style="color:#f92672">},</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">ErrorListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                            <span style="color:#a6e22e">@Override</span>
                            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onErrorResponse</span><span style="color:#f92672">(</span>VolleyError error<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                                error<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
                            <span style="color:#f92672">}</span>
                        <span style="color:#f92672">});</span>
                        queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>bingRequest<span style="color:#f92672">);</span>
                        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;aggiunta richiesta bing&#34;</span><span style="color:#f92672">);</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">},</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">ErrorListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                    <span style="color:#a6e22e">@Override</span>
                    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onErrorResponse</span><span style="color:#f92672">(</span>VolleyError error<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        error<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">});</span>
                queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>yahooRequest<span style="color:#f92672">);</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;aggiunta richiesta yahoo&#34;</span><span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">},</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">ErrorListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onErrorResponse</span><span style="color:#f92672">(</span>VolleyError error<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                error<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
        Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;aggiunta richiesta google&#34;</span><span style="color:#f92672">);</span>
        queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>googleRequest<span style="color:#f92672">);</span></code></pre></div>
<p>Questo tipo di soluzione molto illeggibile quindi è fuori discussione. Dobbiamo trovare un altro modo.</p>
<h3 id="enter-the-future">Enter the Future</h3>
<p>Volley contiene una classe chiamata <em>RequestFuture</em> che può essere considerato come il risultato della richiesta asincrona. Possiamo passare al costruttore di <em>StringRequest</em> un oggetto <em>RequestFuture</em>, dicendo così a volley di mettere il risultato della richiesta http all&rsquo;interno dell&rsquo;oggetto <em>RequestFuture</em>. Per ottenere il risultato della richiesta sarà dunque sufficiente chiamare il metodo <em>get()</em> sull&rsquo;oggetto future. Se il nostro oggetto non ha ancora ricevuto risposta, allora bloccherà il thread sulla quale è eseguito.</p>
<p>Questo è estremamente utile nel problema che abbiamo presentato prima. Proviamo ora a riscrivere il codice di prima con questo nuovo concetto.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> 
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VolleyTutorial</span> <span style="color:#66d9ef">extends</span> AppCompatActivity <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String TAG_RESPONSE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;VOLLEYRESPONSE&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String TAG_ERROR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;VOLLEYERROR&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String TAG_REQUEST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;VOLLEYREQUEST&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> Button sendRequestButton<span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>Bundle savedInstanceState<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">super</span><span style="color:#f92672">.</span><span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>savedInstanceState<span style="color:#f92672">);</span>
        setContentView<span style="color:#f92672">(</span>R<span style="color:#f92672">.</span><span style="color:#a6e22e">layout</span><span style="color:#f92672">.</span><span style="color:#a6e22e">activity_volley_tutorial</span><span style="color:#f92672">);</span>
        sendRequestButton <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>Button<span style="color:#f92672">)</span> findViewById<span style="color:#f92672">(</span>R<span style="color:#f92672">.</span><span style="color:#a6e22e">id</span><span style="color:#f92672">.</span><span style="color:#a6e22e">request_btn</span><span style="color:#f92672">);</span>

        sendRequestButton<span style="color:#f92672">.</span><span style="color:#a6e22e">setOnClickListener</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> View<span style="color:#f92672">.</span><span style="color:#a6e22e">OnClickListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span>
            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">(</span>View view<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                String<span style="color:#f92672">[]</span> urls <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">[]</span> <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;http://www.google.com&#34;</span><span style="color:#f92672">,</span>
                        <span style="color:#e6db74">&#34;http://yahoo.com/&#34;</span><span style="color:#f92672">,</span>
                        <span style="color:#e6db74">&#34;http://www.bing.com&#34;</span>
                <span style="color:#f92672">};</span>
                <span style="color:#66d9ef">new</span> SearchEngineTast<span style="color:#f92672">().</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">(</span>urls<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
    <span style="color:#f92672">}</span>


    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SearchEngineTast</span> <span style="color:#66d9ef">extends</span> AsyncTask<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Void<span style="color:#f92672">,</span> Void<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>

        <span style="color:#a6e22e">@Override</span>
        <span style="color:#66d9ef">protected</span> Void <span style="color:#a6e22e">doInBackground</span><span style="color:#f92672">(</span>String<span style="color:#f92672">...</span> strings<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>strings<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> 3<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span>  <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

            RequestQueue queue <span style="color:#f92672">=</span> Volley<span style="color:#f92672">.</span><span style="color:#a6e22e">newRequestQueue</span><span style="color:#f92672">(</span>VolleyTutorial<span style="color:#f92672">.</span><span style="color:#a6e22e">this</span><span style="color:#f92672">);</span>

            <span style="color:#66d9ef">final</span> String googleUrl <span style="color:#f92672">=</span> strings<span style="color:#f92672">[</span>0<span style="color:#f92672">];</span>
            <span style="color:#66d9ef">final</span> String yahooUrl <span style="color:#f92672">=</span> strings<span style="color:#f92672">[</span>1<span style="color:#f92672">];</span>
            <span style="color:#66d9ef">final</span> String bingUrl <span style="color:#f92672">=</span> strings<span style="color:#f92672">[</span>2<span style="color:#f92672">];</span>

            RequestFuture<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> future <span style="color:#f92672">=</span> RequestFuture<span style="color:#f92672">.</span><span style="color:#a6e22e">newFuture</span><span style="color:#f92672">();</span>
            Response<span style="color:#f92672">.</span><span style="color:#a6e22e">ErrorListener</span> errorListener <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Response<span style="color:#f92672">.</span><span style="color:#a6e22e">ErrorListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
                <span style="color:#a6e22e">@Override</span>
                <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onErrorResponse</span><span style="color:#f92672">(</span>VolleyError error<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    error<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">};</span>

            StringRequest googleRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> googleUrl<span style="color:#f92672">,</span> future<span style="color:#f92672">,</span> errorListener<span style="color:#f92672">);</span>
            StringRequest yahooRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> yahooUrl<span style="color:#f92672">,</span> future<span style="color:#f92672">,</span> errorListener<span style="color:#f92672">);</span>
            StringRequest bingRequest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringRequest<span style="color:#f92672">(</span>Request<span style="color:#f92672">.</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GET</span><span style="color:#f92672">,</span> bingUrl<span style="color:#f92672">,</span> future<span style="color:#f92672">,</span> errorListener<span style="color:#f92672">);</span>

            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>

                queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>googleRequest<span style="color:#f92672">);</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;addedd google request&#34;</span><span style="color:#f92672">);</span>
                String googleResponse <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>5<span style="color:#f92672">,</span> TimeUnit<span style="color:#f92672">.</span><span style="color:#a6e22e">SECONDS</span><span style="color:#f92672">);</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;google response: &#34;</span> <span style="color:#f92672">+</span> googleResponse<span style="color:#f92672">);</span>

                queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>yahooRequest<span style="color:#f92672">);</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;addedd yahoo request&#34;</span><span style="color:#f92672">);</span>
                String yahooResponse <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>5<span style="color:#f92672">,</span> TimeUnit<span style="color:#f92672">.</span><span style="color:#a6e22e">SECONDS</span><span style="color:#f92672">);</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;yahoo response: &#34;</span> <span style="color:#f92672">+</span> yahooResponse<span style="color:#f92672">);</span>

                queue<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>bingRequest<span style="color:#f92672">);</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_REQUEST<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;addedd bing request&#34;</span><span style="color:#f92672">);</span>
                String bingResponse <span style="color:#f92672">=</span> future<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>5<span style="color:#f92672">,</span> TimeUnit<span style="color:#f92672">.</span><span style="color:#a6e22e">SECONDS</span><span style="color:#f92672">);</span>
                Log<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>TAG_RESPONSE<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;bing response: &#34;</span> <span style="color:#f92672">+</span> bingResponse<span style="color:#f92672">);</span>

            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ExecutionException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>TimeoutException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>

            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span></code></pre></div>
<p>Questa volta tutto il codice relativo alle richieste http è stato messo all&rsquo;interno di un <em>AsyncTask</em>, questo perchè il metodo <em>get</em> della classe <em>RequestFuture</em> è bloccante e non vogliamo bloccare il main thread.
Inoltre al metodo get passiamo anche un intervallo di tempo limite oltre il quale non siamo disposti ad aspettare.</p>
<h3 id="creare-la-propria-requestqueue">Creare la propria RequestQueue</h3>
<p>Abbiamo già visto come creare una <em>RequestQueue</em> servendoci del metodo <em>newRequestQueue</em>. Secondo la documentazione android, la nostra <em>RequestQueue</em> dovrebbe essere un <em>Singleton</em>, ovvero non dovrebbero esserci più di una istanza all&rsquo;interno della nostra applicazione. Per ottenere ciò possiamo servirci di una classe che incapsula la nostra <em>RequestQueue</em>. Inoltre per istanziare la nostra <em>RequestQueue</em> ci serviremo dell&rsquo;<em>application context</em> invece che del <em>context</em> relativo ad una singola <em>activity</em>, questo per evitare che la coda venga ricreata ogni volta che viene ricreata l&rsquo;<em>activity</em>.</p>
<p>Ecco un esempio:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> 
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RequestSingleton</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> RequestSingleton mInstance<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> RequestQueue mRequestQueue<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Context mCtx<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">RequestSingleton</span><span style="color:#f92672">(</span>Context context<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        mCtx <span style="color:#f92672">=</span> context<span style="color:#f92672">;</span>
        mRequestQueue <span style="color:#f92672">=</span> getRequestQueue<span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">synchronized</span> RequestSingleton <span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span>Context context<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>mInstance <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            mInstance <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RequestSingleton<span style="color:#f92672">(</span>context<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">return</span> mInstance<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> RequestQueue <span style="color:#a6e22e">getRequestQueue</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>mRequestQueue <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#75715e">// getApplicationContext() is key, it keeps you from leaking the
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// Activity or BroadcastReceiver if someone passes one in.
</span><span style="color:#75715e"></span>            mRequestQueue <span style="color:#f92672">=</span> Volley<span style="color:#f92672">.</span><span style="color:#a6e22e">newRequestQueue</span><span style="color:#f92672">(</span>mCtx<span style="color:#f92672">.</span><span style="color:#a6e22e">getApplicationContext</span><span style="color:#f92672">());</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">return</span> mRequestQueue<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addToRequestQueue</span><span style="color:#f92672">(</span>Request<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> req<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        getRequestQueue<span style="color:#f92672">().</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>req<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span></code></pre></div></p>
<p>Per aggiungere una <em>Request</em> alla nostra coda, ci basterà dunque chiamare l&rsquo;istanza della coda e chiamare il metodo <em>addToRequestQueue()</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">RequestSingleton<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">).</span><span style="color:#a6e22e">addToRequestQueue</span><span style="color:#f92672">(</span>request<span style="color:#f92672">);</span></code></pre></div>

        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=dovidio.github.com%2fpersonalwebsite%2fit%2fpost%2f2017-08-24-volley-android%2f&amp;text=Utilizzare%20Volley%20per%20eseguire%20richieste%20http&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=dovidio.github.com%2fpersonalwebsite%2fit%2fpost%2f2017-08-24-volley-android%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=dovidio.github.com%2fpersonalwebsite%2fit%2fpost%2f2017-08-24-volley-android%2f&amp;title=Utilizzare%20Volley%20per%20eseguire%20richieste%20http" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=dovidio.github.com%2fpersonalwebsite%2fit%2fpost%2f2017-08-24-volley-android%2f&amp;title=Utilizzare%20Volley%20per%20eseguire%20richieste%20http" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=dovidio.github.com%2fpersonalwebsite%2fit%2fpost%2f2017-08-24-volley-android%2f&amp;title=Utilizzare%20Volley%20per%20eseguire%20richieste%20http" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=dovidio.github.com%2fpersonalwebsite%2fit%2fpost%2f2017-08-24-volley-android%2f&amp;description=Utilizzare%20Volley%20per%20eseguire%20richieste%20http" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="dovidio.github.com/personalwebsite/it/post/2017-08-17-guida-intent-android/" data-toggle="tooltip" data-placement="top" title="Passare da un Activity all&#39;altra con gli Intent">&larr; Articolo precedente</a>
            </li>
          
          
            <li class="next">
              <a href="dovidio.github.com/personalwebsite/it/post/2017-09-19-multitimer-android/" data-toggle="tooltip" data-placement="top" title="Gestisci multipli timer con MultiTimer">Articolo successivo &rarr;</a>
            </li>
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2020
          

          
            &nbsp;&bull;&nbsp;
            <a href="dovidio.github.com/personalwebsite/it/">Umberto D&#39;Ovidio</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Sviluppato con Hugo v0.72.0</a> &nbsp;&bull;&nbsp; Tema <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adattato da <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="dovidio.github.com/personalwebsite/js/main.js"></script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="dovidio.github.com/personalwebsite/js/load-photoswipe.js"></script>









    
  </body>
</html>

